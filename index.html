<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Elegance Italian Interior Design — Papier Peint Personnalisé</title>
  <style>
    :root{
      --bg:#0b0c10;
      --card:#11131a;
      --muted:#9aa4ad;
      --accent:#e6c45a;
      --accent-2:#8ad1ff;
      --text:#f2f5f7;
      --green:#9fe870;
      --pink:#ff7fb0;
      --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1000px 500px at 10% -10%, #152033 0%, transparent 60%), 
                  radial-gradient(800px 400px at 120% -10%, #2c1a20 0%, transparent 60%), 
                  var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }
    a{color:inherit}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    /* Hero */
    .hero{
      position:relative;
      padding:80px 24px 40px;
      overflow:hidden;
    }
    .glow{
      position:absolute; inset:-20%;
      background: radial-gradient(800px 300px at 20% 20%, rgba(230,196,90,.25), transparent 60%),
                  radial-gradient(600px 260px at 80% 0%, rgba(138,209,255,.15), transparent 60%);
      filter: blur(40px); pointer-events:none;
      transform: translateZ(0);
    }
    .title{
      font-size: clamp(28px, 4.6vw, 64px);
      line-height:1.05;
      letter-spacing:-0.02em;
      margin:0 0 12px;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .subtitle{color:var(--muted);font-size:clamp(14px,1.6vw,18px);max-width:860px}
    .hero-cards{
      display:grid;grid-template-columns: repeat(5, minmax(180px,1fr));gap:16px;margin-top:28px
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      padding:16px;
      min-height:140px;
      position:relative;
      overflow:hidden;
      transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
      box-shadow: 0 6px 30px rgba(0,0,0,.25) inset, 0 4px 20px rgba(0,0,0,.15);
      cursor:pointer;
    }
    .card:hover{transform: translateY(-6px); border-color: rgba(255,255,255,.18)}
    .card h4{margin:0 0 8px;font-size:18px}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12); color:var(--muted);font-size:12px}
    .badge{width:10px;height:10px;border-radius:50%}
    /* Configurator */
    .section{padding:32px 24px}
    .grid{
      display:grid;grid-template-columns: 420px 1fr; gap:22px; align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr;gap:14px}
    }
    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      padding:18px;
      position:sticky; top:14px;
    }
    .panel h3{margin:0 0 6px}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .label{font-size:12px;color:var(--muted);letter-spacing:.04em;text-transform:uppercase}
    .control{width:100%}
    input[type="text"], input[type="number"], select{
      width:100%; background:#0e1218; border:1px solid rgba(255,255,255,.12); color:var(--text);
      border-radius:10px;padding:10px 12px; outline:none; transition:border .2s ease;
    }
    input[type="range"]{width:100%}
    input[type="text"]:focus, input[type="number"]:focus, select:focus{border-color: rgba(230,196,90,.6)}
    .btn{
      appearance:none;border:none;border-radius:12px;padding:12px 14px;background:linear-gradient(180deg,#1b2433,#131925);
      color:var(--text); cursor:pointer; transition: transform .15s ease, background .2s ease, box-shadow .2s ease;
      border:1px solid rgba(255,255,255,.08);
    }
    .btn:hover{transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.35)}
    .btn.primary{background: linear-gradient(180deg, #e6c45a, #dfb735); color:#19150a}
    .btn.ghost{background:transparent;border:1px dashed rgba(255,255,255,.25)}
    .swatches{display:flex; flex-wrap:wrap; gap:8px}
    .swatch{width:28px;height:28px;border-radius:8px;border:1px solid rgba(255,255,255,.2);cursor:pointer;transition: transform .15s ease}
    .swatch:hover{transform: scale(1.06)}
    .thumbs{display:grid;grid-template-columns:repeat(6, 1fr); gap:8px}
    .thumb{aspect-ratio:1/1;border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,.08); background:#0d1117; cursor:pointer; position:relative}
    .thumb canvas, .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .thumb::after{content:""; position:absolute; inset:0; box-shadow: inset 0 0 0 2px transparent; border-radius:10px; transition:.2s}
    .thumb.active::after{box-shadow: inset 0 0 0 2px var(--accent)}
    /* Preview */
    .stage{
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px; padding:14px; position:relative; overflow:hidden;
      min-height:520px;
    }
    .room{
      position:relative;
      height:520px;
      border-radius:14px;
      background: linear-gradient(180deg, #ececec, #d9d9d9);
      overflow:hidden;
      box-shadow: inset 0 -80px 120px rgba(0,0,0,.15);
      transform: perspective(1200px) rotateX(0.5deg) rotateY(-0.6deg);
    }
    .wall{
      position:absolute; inset:0; margin:40px; border-radius:10px;
      background:#fafafa; box-shadow: 0 40px 80px rgba(0,0,0,.2);
      overflow:hidden;
    }
    .pattern-layer, .overlay-layer{
      position:absolute; inset:0;
    }
    .overlay-layer{
      pointer-events:none;
      background: radial-gradient(900px 300px at -40% -50%, rgba(0,0,0,.18), transparent 60%),
                  radial-gradient(900px 260px at 120% -40%, rgba(0,0,0,.13), transparent 60%);
      mix-blend-mode:multiply;
    }
    .drag-hint{
      position:absolute; bottom:12px; right:12px; font-size:12px; color:#000; background:rgba(255,255,255,.7);
      padding:6px 10px; border-radius:999px;
    }
    .pricebar{display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); padding:12px 16px; border-radius:12px; margin-top:12px}
    .pricebar strong{font-size:20px}
    .note{color:var(--muted); font-size:12px}
    .hidden{display:none !important}
    .divider{height:1px;background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,0)); margin:12px 0}
    .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:600px){ .thumbs{grid-template-columns:repeat(3,1fr)} .grid-2{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="hero container">
    <div class="glow"></div>
    <h1 class="title">Papier Peint Haut de Gamme<br/> configurateur temps réel</h1>
    <p class="subtitle">Créez un décor unique : choisissez une collection (Smart, Kids, Prestige, 3D, Gold), ajustez les dimensions, importez votre motif ou sélectionnez un pattern premium. Prévisualisation instantanée, rendu ultra‑net, animations fluides.</p>
    <div class="hero-cards">
      <div class="card" data-collection="Smart"><h4>Smart Collection</h4><span class="pill"><span class="badge" style="background:var(--accent)"></span>Texturé chic</span></div>
      <div class="card" data-collection="Kids"><h4>Kids Collection</h4><span class="pill"><span class="badge" style="background:var(--pink)"></span>Ludique & doux</span></div>
      <div class="card" data-collection="Prestige"><h4>Prestige Collection</h4><span class="pill"><span class="badge" style="background:#b3b3b3"></span>Intissé premium</span></div>
      <div class="card" data-collection="3D"><h4>3D Collection</h4><span class="pill"><span class="badge" style="background:var(--accent-2)"></span>Relief immersif</span></div>
      <div class="card" data-collection="Gold"><h4>Gold Collection</h4><span class="pill"><span class="badge" style="background:gold"></span>Finitions métal</span></div>
    </div>
  </div>

  <div class="container section">
    <div class="grid">
      <!-- CONTROL PANEL -->
      <div class="panel">
        <h3>Paramètres</h3>
        <div class="label">Collection</div>
        <select id="collection">
          <option>Smart</option>
          <option>Kids</option>
          <option>Prestige</option>
          <option>3D</option>
          <option>Gold</option>
        </select>

        <div class="divider"></div>

        <div class="label">Motif & sources</div>
        <div class="row">
          <button class="btn ghost" id="uploadBtn">Importer une image</button>
          <input id="fileInput" type="file" accept="image/*" class="hidden" />
        </div>
        <div class="note">…ou choisissez un motif prêt à l’emploi ci‑dessous :</div>
        <div class="thumbs" id="patterns"></div>

        <div class="divider"></div>

        <div class="grid-2">
          <div>
            <div class="label">Largeur (m)</div>
            <input id="w" type="number" min="0.5" step="0.1" value="3.0"/>
          </div>
          <div>
            <div class="label">Hauteur (m)</div>
            <input id="h" type="number" min="0.5" step="0.1" value="2.5"/>
          </div>
        </div>

        <div class="label" style="margin-top:8px">Matière</div>
        <select id="material">
          <option value="90">Vinyle Mat — 90 €/m²</option>
          <option value="110" selected>Intissé Premium — 110 €/m²</option>
          <option value="140">Vinyle Satiné — 140 €/m²</option>
        </select>

        <div class="divider"></div>

        <div class="label">Réglages du motif</div>
        <div class="row">
          <input id="scale" type="range" min="20" max="300" value="100"/>
        </div>
        <div class="row">
          <input id="rotation" type="range" min="-180" max="180" value="0"/>
        </div>
        <div class="row">
          <button class="btn" id="reset">Réinitialiser</button>
          <button class="btn" id="download">Télécharger l’aperçu</button>
        </div>

        <div class="pricebar">
          <div>
            <div class="label">Prix estimé</div>
            <strong id="price">—</strong>
          </div>
          <div class="note"><span id="surface">0</span> m² • TVA incl.</div>
        </div>
      </div>

      <!-- PREVIEW -->
      <div class="stage">
        <div class="room">
          <div class="wall">
            <canvas id="preview" class="pattern-layer"></canvas>
            <div class="overlay-layer"></div>
            <div class="drag-hint">Glisser pour déplacer • molette = zoom</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ---------- Utilities ----------
    const $ = (q)=>document.querySelector(q);
    const clamp = (v,mi,ma)=>Math.max(mi,Math.min(ma,v));

    // ---------- Hero card -> set collection ----------
    document.querySelectorAll('.card').forEach(c => {
      c.addEventListener('click', () => {
        $('#collection').value = c.dataset.collection;
        generatePatterns();
        flashPanel();
      });
    });
    function flashPanel(){
      const p = document.querySelector('.panel');
      p.style.boxShadow = '0 0 0 2px rgba(230,196,90,.7) inset, 0 8px 30px rgba(230,196,90,.15)';
      setTimeout(()=> p.style.boxShadow='', 450);
    }

    // ---------- Preview Canvas Setup ----------
    const canvas = document.getElementById('preview');
    const ctx = canvas.getContext('2d');
    const wall = document.querySelector('.wall');
    function fitCanvas(){
      const r = wall.getBoundingClientRect();
      canvas.width = r.width;
      canvas.height = r.height;
      draw();
    }
    window.addEventListener('resize', fitCanvas);
    fitCanvas();

    // State
    const state = {
      baseColor: '#ffffff',
      patternImg: null,
      patternType: 'tile',
      scale: 1.0,
      rotation: 0,
      offsetX: 0,
      offsetY: 0,
      widthM: 3.0,
      heightM: 2.5,
      pricePerM2: 110
    };

    // ---------- Pattern generation (procedural) ----------
    const patternsEl = document.getElementById('patterns');
    function makePatternCanvas(w, h, drawer){
      const c = document.createElement('canvas'); c.width=w; c.height=h; const x=c.getContext('2d'); drawer(x,w,h); return c;
    }
    function stripes(x,w,h){ x.fillStyle='#ddd'; x.fillRect(0,0,w,h); for(let i=0;i<w;i+=16){ x.fillStyle= i%32? '#f6f6f6':'#e9e9e9'; x.fillRect(i,0,8,h);} }
    function dots(x,w,h){ x.fillStyle='#f7f7f7'; x.fillRect(0,0,w,h); x.fillStyle='#dcdcdc'; for(let y=8;y<h;y+=24){ for(let i=8;i<w;i+=24){ x.beginPath(); x.arc(i,y,3,0,6.28); x.fill(); } } }
    function chevrons(x,w,h){
      x.fillStyle='#f4f4f4'; x.fillRect(0,0,w,h);
      x.strokeStyle='#e2e2e2'; x.lineWidth=3; 
      for(let y=0;y<h+40;y+=24){ x.beginPath();
        for(let i=-20;i<w+20;i+=20){ x.moveTo(i,y); x.lineTo(i+10,y-10); x.lineTo(i+20,y); }
        x.stroke();
      }
    }
    function grid(x,w,h){ x.fillStyle='#fafafa'; x.fillRect(0,0,w,h); x.strokeStyle='#e5e5e5'; x.lineWidth=1.5; for(let i=0;i<w;i+=18){ x.beginPath(); x.moveTo(i,0); x.lineTo(i,h); x.stroke(); } for(let j=0;j<h;j+=18){ x.beginPath(); x.moveTo(0,j); x.lineTo(w,j); x.stroke(); } }
    function waves(x,w,h){
      x.fillStyle='#f9f9f9'; x.fillRect(0,0,w,h);
      x.strokeStyle='#e5e5e5'; x.lineWidth=2;
      for(let y=10;y<h;y+=20){
        x.beginPath();
        for(let t=0;t<w;t+=2){ x.lineTo(t, y + Math.sin((t+y)/22)*4 ); }
        x.stroke();
      }
    }
    const generatorsByCollection = {
      'Smart':[stripes, grid, chevrons, dots, waves, grid],
      'Kids':[dots, waves, stripes, grid, chevrons, dots],
      'Prestige':[grid, stripes, chevrons, dots, waves, grid],
      '3D':[chevrons, grid, stripes, waves, dots, chevrons],
      'Gold':[stripes, dots, grid, chevrons, waves, stripes]
    };

    function generatePatterns(){
      const coll = $('#collection').value;
      patternsEl.innerHTML='';
      (generatorsByCollection[coll]||[grid,stripes,dots,chevrons,waves]).forEach((fn, idx)=>{
        const c = makePatternCanvas(120,120,fn);
        const wrap = document.createElement('div');
        wrap.className='thumb';
        wrap.title = coll+' #' + (idx+1);
        wrap.appendChild(c);
        wrap.addEventListener('click',()=>{
          document.querySelectorAll('.thumb').forEach(t=>t.classList.remove('active'));
          wrap.classList.add('active');
          state.patternImg = c;
          draw(true);
        });
        patternsEl.appendChild(wrap);
        if(idx===0){ wrap.click(); }
      });
    }
    generatePatterns();

    // ---------- Upload ----------
    $('#uploadBtn').addEventListener('click', ()=> $('#fileInput').click());
    $('#fileInput').addEventListener('change', (e)=>{
      const file = e.target.files[0]; if(!file) return;
      const url = URL.createObjectURL(file);
      const img = new Image(); img.onload = ()=>{ state.patternImg = img; draw(true); URL.revokeObjectURL(url); };
      img.crossOrigin='anonymous'; img.src = url;
    });

    // ---------- Controls ----------
    $('#w').addEventListener('input',()=>{ state.widthM=parseFloat($('#w').value)||1; updatePrice(); });
    $('#h').addEventListener('input',()=>{ state.heightM=parseFloat($('#h').value)||1; updatePrice(); });
    $('#material').addEventListener('change',()=>{ state.pricePerM2=parseFloat($('#material').value); updatePrice(); });
    $('#scale').addEventListener('input',()=>{ state.scale = parseFloat($('#scale').value)/100; draw(); });
    $('#rotation').addEventListener('input',()=>{ state.rotation = parseFloat($('#rotation').value) * Math.PI/180; draw(); });
    $('#reset').addEventListener('click',()=>{ state.scale=1; state.rotation=0; state.offsetX=state.offsetY=0; $('#scale').value=100; $('#rotation').value=0; draw(true); });
    $('#download').addEventListener('click',()=>{
      const link = document.createElement('a');
      link.download = 'aperçu-papier-peint.png';
      link.href = canvas.toDataURL('image/png', 0.95);
      link.click();
    });
    updatePrice();
    function updatePrice(){
      const s = (state.widthM * state.heightM);
      $('#surface').textContent = s.toFixed(2);
      const price = s * state.pricePerM2;
      $('#price').textContent = Intl.NumberFormat('fr-FR',{style:'currency', currency:'EUR'}).format(price);
    }

    // ---------- Draw pattern onto wall ----------
    function draw(smooth){
      if(!state.patternImg){ ctx.fillStyle='#f5f5f5'; ctx.fillRect(0,0,canvas.width,canvas.height); return; }
      const w = canvas.width, h = canvas.height;
      ctx.save();
      ctx.clearRect(0,0,w,h);
      // background base
      ctx.fillStyle = '#f7f7f7';
      ctx.fillRect(0,0,w,h);

      // transform for rotation/scale/offset
      ctx.translate(w/2, h/2);
      ctx.rotate(state.rotation);
      ctx.scale(state.scale, state.scale);
      ctx.translate(state.offsetX, state.offsetY);

      // Create pattern
      const pat = ctx.createPattern(state.patternImg, 'repeat');
      ctx.fillStyle = pat;
      // Huge rect to cover
      const R = Math.hypot(w,h)*2;
      ctx.fillRect(-R, -R, R*2, R*2);

      ctx.restore();

      if(smooth){
        canvas.animate([{opacity:.6},{opacity:1}], {duration:180, easing:'ease-out'});
      }
    }

    // ---------- Pan & zoom (Nike-like feel) ----------
    let last = null;
    canvas.addEventListener('mousedown', e => { last=[e.clientX, e.clientY]; });
    window.addEventListener('mouseup', ()=> last=null);
    window.addEventListener('mousemove', e=>{
      if(!last) return;
      const dx = (e.clientX - last[0]) / 1.0;
      const dy = (e.clientY - last[1]) / 1.0;
      state.offsetX += dx / (80/state.scale);
      state.offsetY += dy / (80/state.scale);
      last=[e.clientX, e.clientY];
      draw();
    }, {passive:true});

    canvas.addEventListener('wheel', e=>{
      e.preventDefault();
      const delta = -Math.sign(e.deltaY) * 0.06;
      state.scale = clamp(state.scale + delta, 0.2, 3);
      $('#scale').value = Math.round(state.scale*100);
      draw();
    }, {passive:false});

    // ---------- Sync collection dropdown to regenerate patterns ----------
    $('#collection').addEventListener('change', generatePatterns);

    // Initial render
    draw(true);
  </script>
</body>
</html>
